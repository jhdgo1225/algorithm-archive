SELECT TB1.PRODUCT_CODE, SUM(TB2.SALES_AMOUNT) * TB1.PRICE AS SALES
FROM PRODUCT AS TB1 NATURAL JOIN OFFLINE_SALE AS TB2
GROUP BY TB1.PRODUCT_CODE
ORDER BY SALES DESC, TB1.PRODUCT_CODE;